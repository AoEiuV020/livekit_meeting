# meeting_module

A new Flutter module project.

## Getting Started

For help getting started with Flutter development, view the online
[documentation](https://flutter.dev/).

For instructions integrating Flutter modules to your existing applications,
see the [add-to-app documentation](https://flutter.dev/to/add-to-app).

### android
```shell
flutter build aar
```

### ios
```shell
flutter build ios-framework
```
> Error: The plugin "meeting_flutter" requires a higher minimum iOS deployment version than your application is targeting.
To build, increase your application's deployment target to at least 13.0 as described at https://flutter.dev/to/ios-deploy
Error running pod install

报错后手动编辑生成的.ios/Podfile，第一行指定最低版本13，
```
platform :ios, '13.0'
```
ios项目添加依赖需要pod，新xocde项目安装pod有个bug，  
先按这个"Convert to Group",  
https://github.com/CocoaPods/CocoaPods/issues/12456#issuecomment-2298010983  
然后按这个改“objectVersion = 56”，  
https://github.com/CocoaPods/CocoaPods/issues/12456#issuecomment-2325605887  
再pod init就成功了，虽然还有警告，但也只能无视了，  
> [!] [!] Xcodeproj doesn't know about the following attributes {"minimizedProjectReferenceProxies"=>"1", "preferredProjectObjectVersion"=>"77"} for the 'PBXProject' isa.
If this attribute was generated by Xcode please file an issue: https://github.com/CocoaPods/Xcodeproj/issues/new

装上pod后的项目启动失败了，  
> Sandbox: rsync.samba(1222) deny(1) file-write-create

https://stackoverflow.com/a/76626156/5615186  

## example

### ios
```shell
cd example/ios
pod install
# 清理build
xcodebuild clean -workspace meetingmoduleexample.xcworkspace -scheme meetingmoduleexample

# 简单编译测试
xcodebuild build \
  -workspace meetingmoduleexample.xcworkspace \
  -scheme meetingmoduleexample \
  -configuration Debug
# 编译并导出未签名的archive
xcodebuild archive \
  -workspace meetingmoduleexample.xcworkspace \
  -scheme meetingmoduleexample \
  -configuration Release \
  -archivePath build/meetingmoduleexample.xcarchive \
  CODE_SIGN_IDENTITY="" \
  CODE_SIGNING_REQUIRED=NO \
  CODE_SIGNING_ALLOWED=NO
```

### iosoc
> Sandbox: dart(25653) deny(1) file-write-create /Users/aoeiuv/Library/Developer/Xcode/DerivedData/...

update your Xcode project build option 'ENABLE_USER_SCRIPT_SANDBOXING' to 'No'.  
https://stackoverflow.com/a/76792332/5615186  

> SWIFT_VERSION '' is unsupported, supported versions are: 4.0, 4.2, 5.0, 6.0.

项目设置build settings直接搜SWIFT_VERSION设置，  

> Use of undeclared identifier 'LivekitDemoViewController'

oc项目中的swift类必须声明public，而swift项目中的swift类就不需要public也能被oc引用，  

### iosocframework
添加所有flutter生成的framework，  
/packages/meeting_module/build/ios/framework/Debug
将这些 framework 拖入项目中（选择 Copy items if needed）
在 Build Phases -> Link Binary With Libraries 中确保添加了这些 framework
在 Build Settings -> Framework Search Paths 中添加 framework 所在路径
在 General -> Frameworks, Libraries, and Embedded Content 中设置这些 framework 为 "Embed & Sign"

> MyObjectiveCViewController.m:3:9 'GeneratedPluginRegistrant.h' file not found

改成 #import "FlutterPluginRegistrant/GeneratedPluginRegistrant.h"  
只有framework方式依赖需要这样，

> Undefined symbol: _OBJC_CLASS_$_RTCAudioSession

webrtc的framework需要单独添加，  
/example/ios/Pods/WebRTC-SDK  
